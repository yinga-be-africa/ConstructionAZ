define("@widget/LAYOUT/bs-ComponentGoPay-d63d303e.js",["exports","~/c/bs-_rollupPluginBabelHelpers","~/c/bs-ComponentPropTypes","~/c/bs-dataAids","~/c/bs-index"],(function(t,e,a,o,r){"use strict";class s extends(global.React||guac.react).Component{constructor(t){super(t),e._(this,"setupOlaCart",(async()=>{const{websiteId:t,rootDomain:e,env:o,renderMode:r}=this.props;if(!this.gopayCart)try{const s=!!window.sessionStorage;if(!await a.g({shouldUseCache:s,websiteId:t,rootDomain:e}))return;if(this.setState({olaGopayCartOn:!0}),r!==(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH)return;this.gopayCart=await a.l.cartSetup({websiteId:t,env:o}),this.updateOlaStoreState(),this.gopayCartUnsubscribe=this.gopayCart.subscribe(this.updateOlaStoreState),a.h({cart:this.gopayCart,renderMode:r})}catch(t){this.gopayCart=null,this.setState({olaGopayCartOn:!1})}})),e._(this,"updateOlaStoreState",(()=>{if(!this.gopayCart)return;const{quantitiesByType:t}=this.gopayCart.getState(),e=t.service||0;this.setState({olaQuantity:e})})),e._(this,"renderItemCount",(()=>{const t=a.a(this.props.category);return 0===this.totalCartQuantity?null:(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:{...t.wrapper,marginLeft:"!-6px"},"data-aid":o.D.CART_ICON_COUNT},(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Details.Minor,{style:{...t.count,color:"inherit"},featured:!0},this.totalCartQuantity))})),e._(this,"getLinkProps",(()=>this.isPublishMode?{onClick:()=>this.gopayCart.toggle()}:{})),e._(this,"cartRouter",(()=>{const{staticContent:t={}}=this.props,a={link:{display:"flex",alignItems:"center",cursor:this.isPublishMode?"pointer":"not-allowed"}};return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Link,e.a({style:a.link,"aria-label":t.cartIcon||"Shopping Cart Icon"},this.getLinkProps()),this.renderIcon(),this.renderItemCount())})),this.state={olaQuantity:0,olsQuantity:0,olaGopayCartOn:!1},this.dropdownToggleId="cart-dropdown-"+ +new Date}componentDidMount(){this.hasOlaWidget&&this.setupOlaCart()}componentWillUnmount(){this.enabledForOla&&this.gopayCart&&this.gopayCartUnsubscribe&&this.gopayCartUnsubscribe()}get hasOlaWidget(){return!!this.props.appointmentsPageId}get enabledForOla(){return this.hasOlaWidget&&this.state.olaGopayCartOn}get isPublishMode(){return this.props.renderMode===(global.Core||guac["@wsb/guac-widget-core"]).constants.renderModes.PUBLISH}get shouldRender(){return this.enabledForOla}get totalCartQuantity(){const{olsQuantity:t,olaQuantity:e}=this.state;return t+e}renderIcon(){const{cartStyles:t}=this.props;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Icon,{icon:"cart1",style:t,"data-aid":o.D.CART_ICON_RENDER,size:r.I,minTarget:!0})}render(){if(!this.shouldRender)return null;return(global.React||guac.react).createElement((global.Core||guac["@wsb/guac-widget-core"]).UX2.Element.Block,{style:{display:"flex",alignItems:"center",fontSize:"xsmall"},children:this.cartRouter()})}}s.propTypes=a.b,t.default=s,Object.defineProperty(t,"__esModule",{value:!0})})),"undefined"!=typeof window&&(window.global=window);
//# sourceMappingURL=bs-ComponentGoPay-d63d303e.js.map
